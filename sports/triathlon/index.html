<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Triathlon summary, achievements, and personal bests.">
  <title>Triathlon | Nolan Law</title>
  <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
  <header id="site-header" class="site"></header>
  <nav id="site-nav"></nav>
  <main class="container">

    <!-- Hero -->
    <section class="hero">
      <img src="../../assets/images/triathlon-hero.jpg" alt="Triathlon photo" class="hero-img">
      <h1 class="hero-title">Triathlon</h1>
      <p class="hero-sub">My journey in triathlon ‚Äî races, achievements, and personal bests.</p>
    </section>

    <!-- Intro -->
    <section class="intro">
      <p>Since starting triathlon, I‚Äôve competed in multiple races, set personal records, and earned some special achievements along the way. This page brings all that info into one place.</p>
    </section>

    <!-- Feature Cards -->
    <section class="grid featured">
      <div class="feature-card">
        <img src="../../assets/images/results-thumb.jpg" alt="Race results" class="feature-img">
        <h2>üèÖ Race Results</h2>
        <p>A full table of my triathlon race history with times and placements.</p>
        <a href="./results.html" class="btn-primary">View Results</a>
      </div>
      <div class="feature-card">
        <img src="../../assets/images/achievements-thumb.jpg" alt="Achievements" class="feature-img">
        <h2>ü•á Achievements</h2>
        <p>Highlights of milestones, podium finishes, and special race moments.</p>
        <a href="./achievements.html" class="btn-primary">See Achievements</a>
      </div>
      <div class="feature-card">
        <img src="../../assets/images/pb-thumb.jpg" alt="Personal Bests" class="feature-img">
        <h2>‚è± Personal Bests</h2>
        <p>My fastest recorded times in swimming, biking, and running.</p>
        <a href="./personal-bests.html" class="btn-primary">Check Personal Bests</a>
      </div>
    </section>

    <!-- Quick Stats -->
    <section>
      <h2 class="section-title">Highlights at a Glance</h2>
      <div class="grid cards">
        <div class="card">
          <h3>Total Races</h3>
          <p class="kicker" id="total-races">12+</p>
        </div>
        <div class="card">
          <h3>1st Place Finishes</h3>
          <p class="kicker" id="first-places">0</p>
        </div>
        <div class="card">
          <h3>Fastest Sprint Triathlon</h3>
          <p class="kicker" id="fastest-sprint">‚Äî</p>
        </div>
      </div>
    </section>

  </main>
  <footer id="site-footer"></footer>
  <script>window.SITE = {"root":"../../","section":"Sports","title":"Triathlon"};</script>
  <script src="../../js/layout.js"></script>
  <script src="../../js/main.js"></script>
</body>
<script>
document.addEventListener('DOMContentLoaded', async () => {
  const totalEl = document.getElementById('total-races');
  const firstEl = document.getElementById('first-places');
  const sprintEl = document.getElementById('fastest-sprint');

  if (totalEl) totalEl.textContent = '‚Ä¶';
  if (firstEl) firstEl.textContent = '‚Ä¶';
  if (sprintEl) sprintEl.textContent = '‚Ä¶';

  try {
    const res = await fetch('../../assets/data/triathlon-results.json');
    const data = await res.json();

    if (totalEl) totalEl.textContent = data.length;

    const firstCount = data.filter(r =>
      r.overall_place && r.overall_place.trim().toLowerCase().startsWith('1st')
    ).length;
    if (firstEl) firstEl.textContent = firstCount;

    // Only keep Triathlon entries whose distance_category is exactly "Sprint" (case-insensitive)
    const sprintRaces = data.filter(r =>
      r.type && r.type.toLowerCase() === 'triathlon' &&
      r.distance_category && r.distance_category.trim().toLowerCase() === 'sprint' &&
      r.chip_time
    );

    const parseTime = t => {
      if (!t || typeof t !== 'string') return Infinity;
      const parts = t.trim().split(':').map(Number);
      if (parts.length === 2) return parts[0] * 60 + parts[1];           // mm:ss
      if (parts.length === 3) return parts[0] * 3600 + parts[1] * 60 + parts[2]; // hh:mm:ss
      return Infinity;
    };

    if (!sprintRaces.length) {
      if (sprintEl) sprintEl.textContent = '‚Äî';
    } else {
      let fastest = sprintRaces[0];
      for (let i = 1; i < sprintRaces.length; i++) {
        if (parseTime(sprintRaces[i].chip_time) < parseTime(fastest.chip_time)) {
          fastest = sprintRaces[i];
        }
      }
      if (sprintEl) sprintEl.textContent = fastest.chip_time;
    }
  } catch (err) {
    console.error('Error loading triathlon data:', err);
    if (totalEl) totalEl.textContent = '‚Äî';
    if (firstEl) firstEl.textContent = '‚Äî';
    if (sprintEl) sprintEl.textContent = '‚Äî';
  }
});
</script>
</html>
